/* 
QUALITY CHECKS

=========================================
SCRIPT PURPOSE
=========================================
This script performs quality checks
- Find null and duplicate values 
- check for unwanted spaces
- data standardization and consistency
- identify out of range dates
- data consistency between related fields

Usage Notes: 
- Run these scripts after loading the Silver Layer
- Investigate and resolve any descrepancies in data while running scripts
*/

------------------------------------------
DATA CLEANING FOR SILVER LAYER
------------------------------------------

==========================================
Loading data into crm_cust_info
==========================================
-- Data Quality Checks
-- NULL VALUES AND DUPLICATE COUNT
SELECT cst_id,
COUNT(*)
FROM bronze.crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) > 1 OR cst_id IS NULL;

-- CHECK FOR UNWANTED SPACES
SELECT cst_id,
cst_key,
TRIM(cst_firstname),
TRIM(cst_lastname),
cst_gndr
FROM bronze.crm_cust_info;

-- DATA STANDARDIZATION AND CONSISTENCY
SELECT DISTINCT cst_gndr
FROM bronze.crm_cust_info;

-- check data consistency between sales, quantity and price
-- >> Sales = Quantity * price
-- >> Values must not be NULL, zero or negative

SELECT 
sls_sales,
sls_quantity,

sls_price
FROM bronze.crm_sales_details
WHERE sls_sales != sls_quantity * sls_price
OR sls_sales IS NULL OR sls_quantity IS NULL OR sls_price IS NULL
OR sls_sales <= 0 OR sls_quantity <=0 OR sls_price <=0
